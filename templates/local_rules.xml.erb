<!-- This file created by puppet
     Update by adding local_rules and rule_exclude inthe hiera
  -->

<group name="puppet-controlled">

  <!--
  <rule id="100001" level="5">
    <if_sid>5716</if_sid>
    <srcip>1.1.1.1</srcip>
    <description>sshd: authentication failed from IP 1.1.1.1.</description>
    <group>authentication_failed,pci_dss_10.2.4,pci_dss_10.2.5,</group>
  </rule>
  -->


  <!-- This example will ignore ssh failed logins for the user name XYZABC.
    -->
  <!--
  <rule id="100020" level="0">
    <if_sid>5711</if_sid>
    <user>XYZABC</user>
    <description>Example of rule that will ignore sshd </description>
    <description>failed logins for user XYZABC.</description>
  </rule>
  -->


  <!-- Specify here a list of rules to ignore. -->
<% if @rule_exclude %>
  <rule id="100000" level="0">
    <if_sid><%= @rule_exclude.join(",") %></if_sid>
    <description>List of rules to be ignored.</description>
  </rule>
<% end -%>

  <!-- Locally defined rule overrides. -->
<% if #local_rules -%>
<% @local_rules.each do |rule| -%>
  <rule id="<%= rule['id'] %>" level="<%= rule['level'] %>">
<% if rule['if_sid'] %>    <if_sid><%= rule['if_sid'] %></if_sid><% end -%>
<% if rule['srcip'] %>    <srcip><%= rule['srcip'] %></srcip><% end -%>
<% if rule['user'] %>    <user><%= rule['user'] %></user><% end -%>
<% if rule['group'] %>    <group><%= rule['group'] %></group><% end -%>
<% if rule['description'] %>    <description><%= rule['description'] %></description><% end -%>
  </rule>
<% end -%>
<% end -%>

</group> 

<!-- EOF -->
